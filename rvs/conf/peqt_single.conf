# PEQT test #1
# testing conditions:
# 1. all AMD compatible GPUs
# 2. all types of devices
# 3. no regular expressions
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if at least one AMD compatible GPU is registered within the system, FALSE otherwise


actions:
- name: pcie_act_1
  module: peqt
  capability:
    link_cap_max_speed:
    link_cap_max_width:
    link_stat_cur_speed:
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #2
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. all types of devices
# 3. no regular expressions
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list, FALSE otherwise


- name: pcie_act_2
  module: peqt
  capability:
    link_cap_max_speed:
    link_cap_max_width:
    link_stat_cur_speed:
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #3
# testing conditions:
# 1. all AMD compatible GPUs
# 2. a given device type (deviceid filtering)
# 3. no regular expressions
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if at least one AMD compatible GPU (registered within the system) matches the <deviceid>, FALSE otherwise


- name: pcie_act_3
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed:
    link_cap_max_width:
    link_stat_cur_speed:
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #4
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. no regular expressions
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list
# and also matches the <deviceid>, FALSE otherwise


- name: pcie_act_4
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed:
    link_cap_max_width:
    link_stat_cur_speed:
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #5
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. no regular expressions
# 4. only a subset of PCIe capabilities
# Expected PCIe check RESULT = TRUE if at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list
# and also matches the <deviceid>, FALSE otherwise


- name: pcie_act_5
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed:
    link_cap_max_width:
    link_stat_cur_speed:
    link_stat_neg_width:
    dev_serial_num:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #6
# testing conditions:
# 1. all AMD compatible GPUs
# 2. all types of devices
# 3. a simple regular expression for <link_cap_max_speed> capability
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if all <link_cap_max_speed> values match the given regular expression
# and at least one AMD compatible GPU is registered within the system
# FALSE otherwise

- name: pcie_act_6
  module: peqt
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
    link_stat_cur_speed:
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V: 'NOT SUPPORTED'
    D0_Sustained_Power_12V: 'SUPPORTED'
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #7
# testing conditions:
# 1. all AMD compatible GPUs
# 2. all types of devices
# 3. 2 simple regular expressions, as follows: one for <link_cap_max_speed> capability and another one for the <link_stat_cur_speed>
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one AMD compatible GPU is registered within the system and
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression
# FALSE otherwise


- name: pcie_act_7
  module: peqt
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
    link_stat_cur_speed: '^(5 GT\/s)$'
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064
# PEQT test #8
# testing conditions:
# 1. all AMD compatible GPUs
# 2. all types of devices
# 3. 3 simple regular expressions, as follows: one for <link_cap_max_speed> capability, another one for the <link_stat_cur_speed> and an erroneous one for <slot_pwr_limit_value>
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one AMD compatible GPU is registered within the system and
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression
# FALSE otherwise
# Notice: <slot_pwr_limit_value> regular expression is not valid and will be skipped
# without affecting the PEQT modules' check RESULT (however, an error will be logged out)


- name: pcie_act_8
  module: peqt
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
    link_stat_cur_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_stat_neg_width:
    slot_pwr_limit_value: '[a-b][d-'
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #9
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. all types of devices
# 3. 2 simple regular expressions, as follows: one for <link_cap_max_speed> capability and another one for the <link_stat_cur_speed>
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list and
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression
# FALSE otherwise


- name: pcie_act_9
  module: peqt
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
   link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver:
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #10
# testing conditions:
# 1. all AMD compatible GPUs
# 2. a given device type (deviceid filtering)
# 3. 3 simple regular expressions, as follows: one for <link_cap_max_speed> capability, another one for the <link_stat_cur_speed> and one for <kernel_driver>
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one AMD compatible GPU (registered within the system) matches the <deviceid> and
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression and
#  - all <kernel_driver> values match the given regular expression
# FALSE otherwise


- name: pcie_act_10
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
    link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver: ^amdgpu$
    dev_serial_num:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #11
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. 3 simple regular expressions, as follows: one for <link_cap_max_speed> capability, another one for the <link_stat_cur_speed> and one for <kernel_driver>
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list and also matches the <deviceid>
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression and
#  - all <kernel_driver> values match the given regular expression
# FALSE otherwise


- name: pcie_act_11
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
    link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width:
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver: ^amdgpu$
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #12
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. 3 simple regular expressions, as follows: one for <link_cap_max_speed> capability, another one for the <link_stat_cur_speed> and one for <kernel_driver>
# 4. only a subset of PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list and also matches the <deviceid>
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> value smatch the given regular expression and
#  - all <kernel_driver> values match the given regular expression
# FALSE otherwise


- name: pcie_act_12
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width:
    link_stat_cur_speed: '^(8 GT\/s)$'
    vendor_id:
   kernel_driver: ^amdgpu$
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #13
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. 5 simple regular expressions, as follows:
#  - one for <link_cap_max_speed> PCIe capability
#  - one for the <link_stat_cur_speed> PCIe capability
#  - one for <kernel_driver>
#  - one for <link_cap_max_width> PCIe capability
#  - one for <link_stat_neg_width> PCIe capability
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list and also matches the <deviceid>
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression and
#  - all <kernel_driver> values match the given regular expression
#  - all <link_cap_max_width> values match the given regular expression
#  - all <link_stat_neg_width> values match the given regular expression
# FALSE otherwise


- name: pcie_act_13
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width: ^(x8|x16)$
    link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width: ^(x8|x16)$
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver: ^amdgpu$
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing:
    atomic_op_32_completer:
    atomic_op_64_completer:
    atomic_op_128_CAS_completer:
  device: 53475 11064

# PEQT test #14
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. 6 simple regular expressions, as follows:
#  - one for <link_cap_max_speed> PCIe capability
#  - one for the <link_stat_cur_speed> PCIe capability
#  - one for <kernel_driver>
#  - one for <link_cap_max_width> PCIe capability
#  - one for <link_stat_neg_width> PCIe capability
#  - one for <atomic_op_completer> PCIe capability
# 4. all PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list and also matches the <deviceid>
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression and
#  - all <kernel_driver> values match the given regular expression
#  - all <link_cap_max_width> values match the given regular expression
#  - all <link_stat_neg_width> values match the given regular expression
#  - all <atomic_op_completer> values match the given regular expression (4 TRUE/FALSE values with whitespace between them)
# FALSE otherwise


- name: pcie_act_14
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width: ^(x8|x16)$
    link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width: ^(x8|x16)$
    slot_pwr_limit_value:
    slot_physical_num:
    device_id: 26273
    vendor_id:
    kernel_driver: ^amdgpu$
    dev_serial_num:
    D0_Maximum_Power_12V:
    D0_Maximum_Power_3_3V:
    D0_Sustained_Power_12V:
    D0_Sustained_Power_3_3V:
    atomic_op_routing: ^((TRUE|FALSE){1})$
    atomic_op_32_completer: ^((TRUE|FALSE){1})$
    atomic_op_64_completer: ^((TRUE|FALSE){1})$
    atomic_op_128_CAS_completer: ^((TRUE|FALSE){1})$
  device: 53475 11064

# PEQT test #15
# testing conditions:
# 1. only a subset of AMD compatible GPUs (device filtering)
# 2. a given device type (deviceid filtering)
# 3. 6 simple regular expressions, as follows:
#  - one for <link_cap_max_speed> PCIe capability
#  - one for the <link_stat_cur_speed> PCIe capability
#  - one for <kernel_driver>
#  - one for <link_cap_max_width> PCIe capability
#  - one for <link_stat_neg_width> PCIe capability
#  - one for <atomic_op_completer> PCIe capability
# 4. only a subset of PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of the AMD compatible GPUs (registered within the system) matches one of the GPU ID in the <device> list and also matches the <deviceid>
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression and
#  - all <kernel_driver> values match the given regular expression
#  - all <link_cap_max_width> values match the given regular expression
#  - all <link_stat_neg_width> values match the given regular expression
#  - all <atomic_op_completer> values match the given regular expression (4 TRUE/FALSE values with whitespace between them)
# FALSE otherwise


- name: pcie_act_15
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width: ^(x8|x16)$
    link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width: ^(x8|x16)$
    kernel_driver: ^amdgpu$
    atomic_op_routing: ^((TRUE|FALSE){1})$
    atomic_op_32_completer: ^((TRUE|FALSE){1})$
  device: 53475 11064

# PEQT test #16
# testing conditions:
# 1. all AMD compatible GPUs
# 2. a given device type (deviceid filtering)
# 3. 6 simple regular expressions, as follows:
#  - one for <link_cap_max_speed> PCIe capability
#  - one for the <link_stat_cur_speed> PCIe capability
#  - one for <kernel_driver>
#  - one for <link_cap_max_width> PCIe capability
#  - one for <link_stat_neg_width> PCIe capability
#  - one for <atomic_op_completer> PCIe capability
# 4. only a subset of PCIe capabilities
# Expected PCIe check RESULT = TRUE if
#  - at least one of AMD compatible GPU matches the <deviceid> and
#  - all <link_cap_max_speed> values match the given regular expression and
#  - all <link_stat_cur_speed> values match the given regular expression and
#  - all <kernel_driver> values match the given regular expression
#  - all <link_cap_max_width> values match the given regular expression
#  - all <link_stat_neg_width> values match the given regular expression
#  - all <atomic_op_completer> values match the given regular expression (4 TRUE/FALSE values with whitespace between them)
# FALSE otherwise


- name: pcie_act_16
  module: peqt
  deviceid: 26273
  capability:
    link_cap_max_speed: '^(2\.5 GT\/s|5 GT\/s|8 GT\/s)$'
    link_cap_max_width: ^(x8|x16)$
    link_stat_cur_speed: '^(8 GT\/s)$'
    link_stat_neg_width: ^(x8|x16)$
    kernel_driver: ^amdgpu$
    atomic_op_routing: ^((TRUE|FALSE){1})$
    atomic_op_32_completer: ^((TRUE|FALSE){1})$
    atomic_op_64_completer: ^((TRUE|FALSE){1})$
    atomic_op_128_CAS_completer: ^((TRUE|FALSE){1})$
  device: 53475 11064

# PEQT test #17
# testing conditions:
# 1. all AMD compatible GPUs
# 2. all types of devices
# 3. no regular expressions
# 4. bus and slot number
# Expected PCIe check RESULT = TRUE if at least one AMD compatible GPU is registered within the system, FALSE otherwise


- name: pcie_act_17
  module: peqt
  capability:
    bus_id:
    slot_physical_num:
  device: 53475 11064
